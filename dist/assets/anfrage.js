(function(){const l=document.querySelector("[data-form='multi-step'] form"),d=l.dataset.name,m=document.querySelectorAll("[data-form='step']"),b=document.querySelector("[data-form='success']"),x=document.querySelector("[data-form='error']"),q=document.querySelectorAll("[data-form='next-btn']"),v=document.querySelector("[data-form='submit-btn']"),E=document.querySelectorAll("[data-form='step-indicator']"),O=document.querySelectorAll("[data-condition-name]"),V=document.querySelectorAll("[data-condition-el]"),T=document.querySelector("[data-repeat='item']");let s=0;function w(e){return e.offsetParent!==null}function k(){O.forEach(e=>{p(e)})}function f(e){m.forEach((a,t)=>{var n,o;t===s?a.style.display="block":a.style.display="none",t===s?(n=E[t])==null||n.classList.add("active"):(o=E[t])==null||o.classList.remove("active")}),k(),c()}function y(e=!1){let a=!0;const t=Array.from(m[s].querySelectorAll("input[required], textarea[required], select[required]"));for(let n=0;n<t.length;n++){if(!w(t[n]))continue;if(!(e?t[n].checkValidity():t[n].reportValidity()))return a=!1}return a}function c(e){y(!0)?(q.forEach(t=>t.classList.remove("disabled")),v.classList.remove("disabled")):(q.forEach(t=>t.classList.add("disabled")),v.classList.add("disabled"))}function F(){V.forEach(e=>e.style.display="none")}function C(){s>0&&s--,f()}function D(){y()&&(s<m.length&&s++,f())}function H(e){let a=document.querySelectorAll("[data-repeat='item']"),t="";return a.forEach((n,o)=>{const r=n.querySelector("[name*='Instrument']").value,i=n.querySelector("[name*='Instrumentenwert']").value,S=n.querySelector("[name*='Wertart']").value;t+=r+`
`+S+`
`+i+`

`}),e.append("Instruments",t),e}function J(e){let a=new FormData(l);if(!y())return;H(a);const t=document.querySelector("[data-form='submit']");t&&(t.innerHTML="Sendet...",t.disabled=!0);const n={method:"POST",body:a,redirect:"follow"},o=l.action;fetch(o,n).then(function(r){if(r.ok){l.style.display="none",b.style.display="block",window.scrollTo({top:0,behavior:"smooth"});const i=document.querySelector(".lottie-trigger");if(!i)return;i.click()}}).catch(function(r){console.error("Error: ",r),b.style.display="none",x.style.display="block"})}function p(e){var o;let a;if(e.dataset.conditionName?a=e:a=e.querySelector("[data-condition-name]"),!(a!=null&&a.dataset))return;let t=document.querySelectorAll(`[data-condition-el="${a.dataset.conditionName}"]`);const n=(o=e.querySelector(":checked"))==null?void 0:o.value;t.forEach(r=>{var I;const i=(I=r==null?void 0:r.dataset)==null?void 0:I.condition.split(",").map(g=>g.trim());function S(g,N){return g.some(h=>Array.from(h)[0]==="!"?h.substring(1)!==N:h===N)}const $=S(i,n);a&&($?r.style.display="block":r.style.display="none")})}function A(e){return e.name.length>0?e.name:e.id.length>0?e.id:null}function R(e){if(!e.target.closest("[data-form='multi-step']"))return;var a=A(e.target);if(!a)return;let t=localStorage.getItem(d);t=t?JSON.parse(t):{},e.target.type==="checkbox"?t[a]=e.target.checked?"on":"off":t[a]=e.target.value,localStorage.setItem(d,JSON.stringify(t))}function B(){let e=localStorage.getItem(d);if(!e)return;e=JSON.parse(e);let a=document.querySelectorAll("[data-auto-save] input, [data-auto-save] textarea, [data-auto-save] select");Array.prototype.slice.call(a).forEach(function(t){let n=A(t);n&&(n.includes("files")||e[n]&&(t.type==="checkbox"?t.checked=e[n]==="on":t.type==="radio"?t.checked=e[n]===t.value:t.value=e[n]))}),k()}let u=1;function M(e){return document.querySelectorAll("[data-repeat='item']")}function P(e){M().length<=1||(e.remove(),u--,c())}function W(e){u++;const a=document.querySelectorAll("[data-repeat='item']");let t=T.cloneNode(!0);t.querySelectorAll("input").forEach((o,r)=>{o.type==="text"||o.type==="number"?(o.value="",o.name+=u):(o.checked=!1,o.name+=u)}),a[a.length-1].after(t),c()}function U(){B(),F(),f(),c()}U(),document.addEventListener("input",function(e){c(),R(e)},!1),document.addEventListener("keypress",function(e){e.key==="Enter"&&L(e)}),document.addEventListener("click",L);function L(e){e.target.matches("[data-form='next-btn']")&&D(),e.target.matches("[data-form='back-btn']")&&C(),e.target.closest("[data-condition]")&&p(e.target.closest("[data-condition]")),e.target.closest("[data-repeat='delete-item']")&&P(e.target.closest("[data-repeat='item']")),e.target.closest("[data-repeat='add-item']")&&W(e.target.closest("[data-repeat='add-item']")),e.target.matches("[data-form='submit-btn']")&&J()}document.addEventListener("change",function(e){c(),e.target.closest("[data-condition-name]")&&p(e.target.closest("[data-condition-name]"))},!0)})();
